<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css" type="text/css">
    <title>Get Weather Form</title>
     <script>
      var apiKey = '0e57c807a628d5e136b3138b7ad24c27';
      document.addEventListener('DOMContentLoaded', weatherGet);
      function weatherGet(){
        document.getElementById('weatherSubmit').addEventListener('click', function(event){
          let zipC = document.getElementById('zipcode').value;
          let cityN = document.getElementById('cityName').value;
          let source;
          var req = new XMLHttpRequest();
          if(zipC == null){
            source = "http://api.openweathermap.org/data/2.5/weather?q=" + cityN + ",us&appid=" + apiKey;
          } else {
            source = "http://api.openweathermap.org/data/2.5/weather?zip=" + zipC + ",us&appid=" + apiKey;
          }
          req.open("GET", source, false);
          req.addEventListener('load', function(){
            let reply = JSON.parse(req.responseText);
            if (req.status > 200 && req.status < 400){
              document.getElementById('city').textContent = reply.city.name;
              document.getElementById('weather').textContent = reply.list.weather.main;
              document.getElementById('foreC').textContent = reply.list.weather.description;
              document.getElementById('humidity').textContent = reply.list.main.humidity;
              document.getElementById('wind').textContent = reply.list.wind.speed;
              document.getElementById('temp').textContent = reply.list.main.temp;               
            } else {
              console.log(reply);
            }
          });
          req.send(null);
          event.preventDefault();
        })
      }
    </script>
  </head>
  <body>
    <form id="weatherForm" method="get">
      <legend> You can use this form to inspect the weather via your location!</legend>
      <fieldset>
        City name: <input type="text" name="cityName" id="cityName" value="Seattle"><br>
        Zip code: <input type="text" name="zipcode" id="zipcode" value="98115"><br><br>
        <input type="submit" value="Search" id="weatherSubmit">
      </fieldset>
    </form>
    <table>                                                          
      <tr>
          <th>City Name:</th>
          <th>Weather:</th>
          <th>Forecast:</th>
          <th>Humidity:</th>
          <th>Wind Speed:</th>
          <th>Temperature:</th>
      </tr>
      <tr>
          <td id="city">Console</td>
          <td id="weather">Console</td>
          <td id="foreC">Console</td>
          <td id="humidity">Console</td>
          <td id="wind">Console</td>
          <td id="temp">Console</td>
        </tr>
    </table>
  </body>
</html>
